---
title: javaå¯¹è±¡åˆå§‹åŒ–é—®é¢˜--é˜¿é‡ŒğŸ®åˆ¨æ
date: 2018-05-02
categories: [åç«¯]
tags: [java,åŸºç¡€]
description: "javaåŸºç¡€æ„ç­‘"
cover_picture: http://oss.willhappy.cn/hexo/cover_pic/cover_picture_23.jpg

---

<!--more-->

[toc]

### ä¸€. whyå¼•å…¥
å› ä¸ºjavaå¯¹è±¡åˆå§‹åŒ–é—®é¢˜æ˜¯æ¯”è¾ƒåŸºç¡€çš„javaçŸ¥è¯†ç‚¹ï¼ŒåŒæ—¶ï¼Œä¹Ÿæ˜¯ä¼—å¤šé¢è¯•ä¸­ç™¾é—®ä¸åŒçš„é—®é¢˜ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬é€šè¿‡é˜¿é‡Œå·¥ç¨‹å¸ˆçš„ä¾‹å­å’Œåˆ¨ææ¥å¥½å¥½ç†è§£ä»–ã€‚

### äºŒ. å¼•å‘é—®é¢˜
ä¼šè§¦å‘Java object initialization order é—®é¢˜ï¼Œè¿™ç§é—®é¢˜æ¯”è¾ƒå°‘è§ã€‚

### ä¸‰. ä¸¾ä¾‹

```java
package com.xn.web.budget;

public class Test2 extends Test {
    public int a = 100;

    public Test2() {
        super();
        System.out.println(a);
        a = 200;
    }

    public static void main(String[] args){
        System.out.println(new Test2().a);
    }
}

package com.xn.web.budget;

public class Test {
    public Test() {
        System.out.println(((Test2)this).a);
    }
}
```

ç»“æœè¾“å‡ºï¼š
```
0
100
200
```

è§£æå¯¹è±¡çš„åˆå§‹åŒ–é¡ºåºï¼š
1. ä¸ºAç±»åˆ†é…å†…å­˜ç©ºé—´ï¼Œåˆå§‹åŒ–æ‰€æœ‰æˆå‘˜å˜é‡ä¸ºé»˜è®¤å€¼ï¼ŒåŒ…æ‹¬primitiveç±»å‹(int=0,boolean=false,â€¦)å’ŒReferenceç±»å‹ã€‚
2. è°ƒç”¨Aç±»æ„é€ å‡½æ•°ã€‚
3. è°ƒç”¨Bç±»æ„é€ å‡½æ•°ã€‚
4. è°ƒç”¨Objectç©ºæ„é€ å‡½æ•°ã€‚ï¼ˆjavaç¼–è¯‘å™¨ä¼šé»˜è®¤åŠ æ­¤æ„é€ å‡½æ•°ï¼Œä¸”objectæ„é€ å‡½æ•°æ˜¯ä¸ªç©ºå‡½æ•°ï¼Œæ‰€ä»¥ç«‹å³è¿”å›ï¼‰
5. **åˆå§‹åŒ–Bç±»æˆå‘˜å˜é‡ï¼Œå› ä¸ºBç±»æ²¡æœ‰æˆå‘˜å˜é‡ï¼Œè·³è¿‡ã€‚**
6. æ‰§è¡Œsysoutè¾“å‡ºå­ç±»Açš„æˆå‘˜å˜é‡å°aã€‚// æ­¤æ—¶ä¸º0
7. **åˆå§‹åŒ–Aç±»æˆå‘˜å˜é‡ï¼Œå°†Aç±»æˆå‘˜å˜é‡å°aèµ‹å€¼100ã€‚**
8. æ‰§è¡Œsysoutè¾“å‡ºå½“å‰Aç±»çš„æˆå‘˜å˜é‡å°aã€‚// æ­¤æ—¶ä¸º100
9. èµ‹å€¼å½“å‰Aç±»çš„æˆå‘˜å˜é‡å°aä¸º200ã€‚
10. mainå‡½æ•°ä¸­æ‰§è¡Œsysoutï¼Œè¾“å‡ºAç±»å®ä¾‹çš„æˆå‘˜å˜é‡å°aã€‚// æ­¤æ—¶ä¸º200

åŠ ç²—çš„é‚£ä¸¤è¡Œæè¿°æ˜¯é‡ç‚¹ï¼Œç»“è®ºæ˜¯**æˆå‘˜å˜é‡åˆå§‹åŒ–æ˜¯åœ¨çˆ¶ç±»æ„é€ å‡½æ•°è°ƒç”¨å®Œåï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œæˆå‘˜å˜é‡çš„å€¼å‡æ˜¯é»˜è®¤å€¼**ã€‚

å…¶å®è¿™ç±»é—®é¢˜ï¼Œç†Ÿæ‚‰åŸç†æ˜¯ä¸€æ–¹é¢ï¼Œæœ¬è´¨ä¸Šåªè¦ä¸åœ¨æ„é€ å‡½æ•°ä¸­æ’å…¥è¿‡å¤šçš„ä¸šåŠ¡é€»è¾‘ï¼Œå‡ºé—®é¢˜çš„æ¦‚ç‡ä¹Ÿä¼šä½å¾ˆå¤šã€‚

æœ€åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹JLSä¸­ç»™å‡ºçš„Javaç±»å¯¹è±¡åˆå§‹åŒ–é¡ºåºå®šä¹‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå¸¦æ¡ä»¶åˆ†æ”¯çš„æµç¨‹æè¿°ï¼š

1. Assign the arguments for the constructor to newly created parameter variables for this constructor invocation.
2. If this constructor begins with an explicit constructor invocation of another constructor in the same class (using this), then evaluate the arguments and process that constructor invocation recursively using these same five steps. If that constructor invocation completes abruptly, then this procedure completes abruptly for the same reason; otherwise, continue with step 5.
3. This constructor does not begin with an explicit constructor invocation of another constructor in the same class (using this). If this constructor is for a class other than Object, then this constructor will begin with an explicit or implicit invocation of a superclass constructor (using super). Evaluate the arguments and process that superclass constructor invocation recursively using these same five steps. If that constructor invocation completes abruptly, then this procedure completes abruptly for the same reason. Otherwise, continue with step 4.
4. Execute the instance initializers and instance variable initializers for this class, assigning the values of instance variable initializers to the corresponding instance variables, in the left-to-right order in which they appear textually in the source code for the class. If execution of any of these initializers results in an exception, then no further initializers are processed and this procedure completes abruptly with that same exception. Otherwise, continue with step 5. (In some early implementations, the compiler incorrectly omitted the code to initialize a field if the field initializer expression was a constant expression whose value was equal to the default initialization value for its type.)
5. Execute the rest of the body of this constructor. If that execution completes abruptly, then this procedure completes abruptly for the same reason. Otherwise, this procedure completes normally.

å¼•ç”¨è‡ªï¼š[ä¼ é€][1]

[1]: http://jm.taobao.org/page/40/
